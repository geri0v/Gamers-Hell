<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Gamers-Hell Teleporters</title>
  <style>
    html, body { margin:0; padding:0; height:100vh }
    body {
      display: grid;
      grid-template-columns:360px 1fr 360px;
      grid-template-areas:"navleft main navright";
      font-family:Arial,sans-serif;
      background:#3c6e8d65; color:#333;
    }
    .sidenav { grid-area:navleft; background:#111; color:#818181; overflow-y:auto }
    .sidenav2{ grid-area:navright;background:#111; color:#818181; overflow-y:auto }
    .main    { grid-area:main; overflow-y:auto; padding:20px }
    .sidenav a, .sidenav2 a {
      display:block; padding:8px 16px; font-size:16px;
      text-decoration:none; color:inherit;
    }
    .sidenav a:hover, .sidenav2 a:hover { color:#f1f1f1 }
    .sidenav details {
      padding:4px 16px; cursor:pointer;
    }
    .sidenav summary {
      list-style:none; font-size:16px; user-select:none;
    }
    .sidenav summary::before {
      content:"▸"; display:inline-block; width:1em;
      transition:transform .2s;
    }
    .sidenav details[open] summary::before { content:"▾" }
    .sidenav details a {
      padding-left:32px; font-size:15px;
    }
    h1,h2 { margin:.5em 0 }
    h2 {
      margin-top:1.5em; border-bottom:1px solid #ccc;
      padding-bottom:.2em;
    }
    .center { text-align:center; margin-bottom:1em }
    .textbox-container {
      display:flex; align-items:center; margin:6px 0;
    }
    .textbox {
      flex:1; padding:6px; font-size:14px;
      border:1px solid #ccc; border-radius:4px;
      background:#fff;
    }
    .copy-button {
      width:24px; height:24px; margin-left:6px;
      border:none; cursor:pointer; border-radius:4px;
      background:url('https://i.postimg.cc/Pf2Qp0Xq/World-Completion.png')
                center/cover no-repeat;
    }
    .copy-button:hover {
      background-image:url('https://i.postimg.cc/qMNzGyvH/pve-e6fdf7c3.png');
    }
    textarea { width:100%; max-width:600px }
    footer {
      text-align:center; padding:1em 0; background:#ececec;
      margin-top:2em; font-size:.9em;
    }
  </style>
</head>
<body>

  <!-- LEFT NAV -->
  <nav class="sidenav" id="sideNav"></nav>

  <!-- MAIN CONTENT -->
  <div class="main">
    <section id="Welcome" class="center">
      <h1>Welcome Commander</h1>
      <script>
        (function(){
          const PASS = "PvE";
          if (prompt("Password?") !== PASS) {
            location.href = "https://sites.google.com/view/gamers-hell-community";
          } else {
            alert("Welcome Commander");
          }
        })();
      </script>
    </section>

    <div id="mainContent"></div>

    <section id="Credits" class="center">
      <h2>Credits</h2>
      <textarea rows="6" disabled>
Gamers-Hell Community
Players Vs Events:
  Blaz, Devilish Rain, Stormmyknight, Beina, Geri V

Websites:
  https://wiki.guildwars2.com/wiki
  https://gw2efficiency.com/
  http://gw2timer.com/
      </textarea>
    </section>

    <footer>&copy; 2025 Gamers-Hell Community</footer>
  </div>

  <!-- RIGHT NAV (Timer) -->
  <nav class="sidenav2">
    <iframe
      src="https://gw2timer.com/?page=Timetable&enu_Language=en&int_setClock=2&bol_use24Hour=true"
      width="100%" height="100%" frameborder="0"
      style="box-shadow:0 0 12px #223;">
    </iframe>
  </nav>

  <!-- SCRIPT: fetch & build UI from Google Sheet -->
  <script>
    const SHEET_ID   = "1drEpltlQrycYXTHHG8K1xiQNvHZgQk0z2JOPgK0E0yA";
    const SHEET_GIDS = [
      "159648992",  // Core Tyria
      "1712489673", // Living World S1
      "1641486649"  // Living World S2
      // add more GIDs here as needed
    ];

    // Fetch one tab via GViz JSON
    async function fetchSheet(id, gid) {
      const url = `https://docs.google.com/spreadsheets/d/${id}/gviz/tq?gid=${gid}&tqx=out:json`;
      const res = await fetch(url);
      if (!res.ok) throw new Error(`HTTP ${res.status}`);
      const txt = await res.text();
      const json = JSON.parse(txt.slice(txt.indexOf("{"), txt.lastIndexOf("}")+1));
      return json.table.rows.map(r => r.c.map(c => c?.v || ""));
    }

    // Fetch all tabs, merge rows (skip headers after the first)
    async function fetchAllSheets(id, gids) {
      let allRows = [];
      for (let i = 0; i < gids.length; i++) {
        const rows = await fetchSheet(id, gids[i]);
        allRows = i === 0
          ? rows
          : allRows.concat(rows.slice(1));
      }
      return allRows;
    }

    // Convert rows → nested { Category: { Subcategory: [ {name,code},… ] } }
    function rowsToNestedData(rows) {
      const data = {};
      const [header, ...body] = rows;
      body.forEach(row => {
        const [cat, sub, name, code] = row.map(x => String(x||"").trim());
        if (!name && !code) return; // skip blank
        const C = cat || "Other";
        const S = sub || "General";
        data[C] = data[C] || {};
        data[C][S] = data[C][S] || [];
        data[C][S].push({ name, code });
      });
      return data;
    }

    // Copy helper
    function copyToClipboard(id) {
      const tb = document.getElementById(id);
      tb.disabled = false;
      tb.select();
      document.execCommand("copy");
      tb.disabled = true;
      alert(`Copied: ${tb.value}`);
    }

    // Build left nav
    function generateNav(data) {
      const nav = document.getElementById("sideNav");
      nav.innerHTML = "";
      // static Welcome
      let a = document.createElement("a");
      a.href = "#Welcome"; a.textContent = "Welcome";
      nav.appendChild(a);
      // dynamic categories
      Object.entries(data).forEach(([cat, subs]) => {
        const details = document.createElement("details");
        const sum     = document.createElement("summary");
        sum.textContent = cat;
        details.appendChild(sum);
        Object.keys(subs).forEach(sub => {
          const link = document.createElement("a");
          link.href = `#${cat.replace(/\s+/g,"")}_${sub.replace(/\s+/g,"")}`;
          link.textContent = sub;
          details.appendChild(link);
        });
        nav.appendChild(details);
      });
      // static Credits
      a = document.createElement("a");
      a.href = "#Credits"; a.textContent = "Credits";
      nav.appendChild(a);
    }

    // Build main content
    function buildContent(data) {
      const container = document.getElementById("mainContent");
      container.innerHTML = "";
      Object.entries(data).forEach(([cat, subs]) => {
        Object.entries(subs).forEach(([sub, items]) => {
          const section = document.createElement("section");
          const id      = `${cat.replace(/\s+/g,"")}_${sub.replace(/\s+/g,"")}`;
          section.id = id;
          const h2 = document.createElement("h2");
          h2.textContent = `${cat} – ${sub}`;
          section.appendChild(h2);

          items.forEach((item, idx) => {
            const wrap = document.createElement("div");
            wrap.className = "textbox-container";

            const inp = document.createElement("input");
            inp.type  = "text";
            inp.className = "textbox";
            inp.value = `${item.name}: ${item.code}`;
            inp.id    = `tb_${id}_${idx}`;
            inp.disabled = true;

            const btn = document.createElement("button");
            btn.className = "copy-button";
            btn.title     = `Copy ${item.name}`;
            btn.onclick   = () => copyToClipboard(inp.id);

            wrap.appendChild(inp);
            wrap.appendChild(btn);
            section.appendChild(wrap);
          });

          container.appendChild(section);
        });
      });
    }

    // Init on load
    document.addEventListener("DOMContentLoaded", async () => {
      try {
        const rows = await fetchAllSheets(SHEET_ID, SHEET_GIDS);
        const data = rowsToNestedData(rows);
        generateNav(data);
        buildContent(data);
      } catch (err) {
        console.error("Error loading data:", err);
        document.getElementById("mainContent").innerHTML =
          `<p style="color:red">Unable to fetch event data.<br>${err.message}</p>`;
      }
    });
  </script>
</body>
</html>
```
